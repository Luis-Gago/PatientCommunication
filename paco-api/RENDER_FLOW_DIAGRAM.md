# ğŸ”„ Render Deployment Flow

## Complete Deployment Process

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     1. CODE PREPARATION                          â”‚
â”‚                                                                  â”‚
â”‚  Developer Machine                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Your Local Repository                            â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ render.yaml          (Blueprint config)     â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ build.sh             (Build script)         â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ start_render.sh      (Startup script)       â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ requirements.txt     (Dependencies)         â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ alembic/             (Database migrations)  â”‚          â”‚
â”‚  â”‚  â””â”€â”€ app/                 (Application code)     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â”‚ git push                             â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Git Repository (GitHub/GitLab/Bitbucket)        â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Webhook / Manual trigger
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    2. RENDER PLATFORM                            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚              Blueprint Detection                 â”‚           â”‚
â”‚  â”‚  â€¢ Reads render.yaml                            â”‚           â”‚
â”‚  â”‚  â€¢ Creates PostgreSQL database                   â”‚           â”‚
â”‚  â”‚  â€¢ Creates Web Service                          â”‚           â”‚
â”‚  â”‚  â€¢ Links database to service                    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                            â”‚                                     â”‚
â”‚                            â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚              BUILD PHASE                         â”‚           â”‚
â”‚  â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚           â”‚
â”‚  â”‚  â•‘  $ ./build.sh                            â•‘   â”‚           â”‚
â”‚  â”‚  â•‘                                          â•‘   â”‚           â”‚
â”‚  â”‚  â•‘  1. pip install --upgrade pip            â•‘   â”‚           â”‚
â”‚  â”‚  â•‘  2. pip install -r requirements.txt      â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     - fastapi                            â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     - uvicorn                            â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     - sqlalchemy                         â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     - alembic                            â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     - psycopg2-binary                    â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     - groq, elevenlabs                   â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     - all other dependencies             â•‘   â”‚           â”‚
â”‚  â”‚  â•‘                                          â•‘   â”‚           â”‚
â”‚  â”‚  â•‘  âœ“ Build Complete                        â•‘   â”‚           â”‚
â”‚  â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                            â”‚                                     â”‚
â”‚                            â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚              STARTUP PHASE                       â”‚           â”‚
â”‚  â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚           â”‚
â”‚  â”‚  â•‘  $ ./start_render.sh                     â•‘   â”‚           â”‚
â”‚  â”‚  â•‘                                          â•‘   â”‚           â”‚
â”‚  â”‚  â•‘  1. Set PYTHONPATH=$(pwd)                â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     â€¢ Ensures app.models can be found    â•‘   â”‚           â”‚
â”‚  â”‚  â•‘                                          â•‘   â”‚           â”‚
â”‚  â”‚  â•‘  2. Run Migrations                       â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     $ alembic upgrade head               â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     â€¢ Create/update database schema      â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     â€¢ Apply all pending migrations       â•‘   â”‚           â”‚
â”‚  â”‚  â•‘                                          â•‘   â”‚           â”‚
â”‚  â”‚  â•‘  3. Start Server                         â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     $ uvicorn app.main:app               â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     --host 0.0.0.0                       â•‘   â”‚           â”‚
â”‚  â”‚  â•‘     --port $PORT                         â•‘   â”‚           â”‚
â”‚  â”‚  â•‘                                          â•‘   â”‚           â”‚
â”‚  â”‚  â•‘  âœ“ Service Running                       â•‘   â”‚           â”‚
â”‚  â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                            â”‚                                     â”‚
â”‚                            â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚              RUNNING SERVICES                     â”‚          â”‚
â”‚  â”‚                                                   â”‚          â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚          â”‚
â”‚  â”‚  â”‚  Web Service: paco-api                   â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  URL: https://paco-api.onrender.com      â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  Port: 10000 (internal)                  â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  FastAPI Application            â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ REST API Endpoints           â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ WebSocket for voice          â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ JWT Authentication           â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Groq LLM Integration         â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ ElevenLabs Voice             â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚                â”‚                          â”‚    â”‚          â”‚
â”‚  â”‚  â”‚                â”‚ DATABASE_URL             â”‚    â”‚          â”‚
â”‚  â”‚  â”‚                â–¼                          â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  PostgreSQL: paco-db            â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ research_ids                 â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ user_sessions                â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ disclaimers                  â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ conversations                â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ medication_adherence         â”‚     â”‚    â”‚          â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚          â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTPS
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       3. CLIENTS                                 â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Web Browser   â”‚   â”‚  Mobile App    â”‚   â”‚  API Client    â”‚ â”‚
â”‚  â”‚  (Frontend)    â”‚   â”‚                â”‚   â”‚  (Postman)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                     â”‚                     â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚              https://paco-api.onrender.com                      â”‚
â”‚              â€¢ GET  /                (Health check)             â”‚
â”‚              â€¢ GET  /docs            (API docs)                 â”‚
â”‚              â€¢ POST /auth/login      (Authentication)           â”‚
â”‚              â€¢ POST /chat/message    (Chat endpoint)            â”‚
â”‚              â€¢ WS   /ws/voice        (Voice WebSocket)          â”‚
â”‚              â€¢ POST /medication/...  (Medication analysis)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Environment Variables Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Environment Variables                        â”‚
â”‚                                                               â”‚
â”‚  Set in Render Dashboard                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  GROQ_API_KEY=gsk_...           (Required)      â”‚        â”‚
â”‚  â”‚  ELEVENLABS_API_KEY=...         (Required)      â”‚        â”‚
â”‚  â”‚  ELEVENLABS_AGENT_ID=...        (Required)      â”‚        â”‚
â”‚  â”‚  SECRET_KEY=...                 (Required)      â”‚        â”‚
â”‚  â”‚  ALGORITHM=HS256                (Optional)      â”‚        â”‚
â”‚  â”‚  ACCESS_TOKEN_EXPIRE_MINUTES=30 (Optional)      â”‚        â”‚
â”‚  â”‚  DATABASE_URL=postgresql://...  (Auto-set)      â”‚        â”‚
â”‚  â”‚  PORT=10000                     (Auto-set)      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                           â”‚                                   â”‚
â”‚                           â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Application Runtime (app/core/config.py)       â”‚        â”‚
â”‚  â”‚  â€¢ Reads environment variables                  â”‚        â”‚
â”‚  â”‚  â€¢ Validates required settings                  â”‚        â”‚
â”‚  â”‚  â€¢ Configures services                          â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Migration Flow (Database Schema Updates)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Alembic Migrations                         â”‚
â”‚                                                               â”‚
â”‚  alembic/versions/                                           â”‚
â”‚  â”œâ”€â”€ 39bc126e2b3a_initial_schema...py                       â”‚
â”‚  â”œâ”€â”€ 694a65473b3d_add_provider...py                         â”‚
â”‚  â””â”€â”€ a5bc8d3e4f2g_add_medication...py                       â”‚
â”‚                           â”‚                                   â”‚
â”‚                           â”‚ alembic upgrade head              â”‚
â”‚                           â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  PostgreSQL Database                             â”‚        â”‚
â”‚  â”‚  â€¢ Apply migration 39bc126e2b3a (if not done)   â”‚        â”‚
â”‚  â”‚  â€¢ Apply migration 694a65473b3d (if not done)   â”‚        â”‚
â”‚  â”‚  â€¢ Apply migration a5bc8d3e4f2g (if not done)   â”‚        â”‚
â”‚  â”‚  â€¢ Update alembic_version table                 â”‚        â”‚
â”‚  â”‚  âœ“ Database schema up-to-date                   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Request Flow (API Call Example)

```
Client Request
     â”‚
     â”‚ POST https://paco-api.onrender.com/chat/message
     â”‚ Authorization: Bearer <jwt_token>
     â”‚ Body: { "message": "What medications should I take?" }
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Render Load Balancer / SSL Termination         â”‚
â”‚  â€¢ HTTPS â†’ HTTP                                 â”‚
â”‚  â€¢ Add headers                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  uvicorn (ASGI Server)                          â”‚
â”‚  â€¢ Receive HTTP request                         â”‚
â”‚  â€¢ Route to FastAPI                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPI Application (app/main.py)              â”‚
â”‚  â€¢ Parse request                                â”‚
â”‚  â€¢ Authenticate JWT token                       â”‚
â”‚  â€¢ Route to endpoint handler                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Endpoint Handler (app/api/endpoints/chat.py)   â”‚
â”‚  â€¢ Validate input                               â”‚
â”‚  â€¢ Call service layer                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Service Layer (app/services/)                  â”‚
â”‚  â€¢ conversation_service.py                      â”‚
â”‚  â€¢ llm_service.py (Groq API call)               â”‚
â”‚  â€¢ medication_analysis_service.py               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  External APIs & Database                       â”‚
â”‚  â€¢ Groq LLM API                                 â”‚
â”‚  â€¢ PostgreSQL Database                          â”‚
â”‚  â€¢ ElevenLabs Voice API                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ Response path (reverse order)
     â–¼
Client receives response
```

## Auto-Deploy Flow (Continuous Deployment)

```
Developer commits code
     â”‚
     â”‚ git push origin main
     â–¼
Git Repository (GitHub/GitLab)
     â”‚
     â”‚ Webhook notification
     â–¼
Render Platform
     â”‚
     â”œâ”€â–º Detect changes
     â”‚
     â”œâ”€â–º Start new build
     â”‚   â€¢ ./build.sh
     â”‚   â€¢ Install dependencies
     â”‚
     â”œâ”€â–º Health check old service (still running)
     â”‚
     â”œâ”€â–º Start new service
     â”‚   â€¢ ./start_render.sh
     â”‚   â€¢ Run migrations
     â”‚   â€¢ Start uvicorn
     â”‚
     â”œâ”€â–º Health check new service
     â”‚
     â”œâ”€â–º Zero-downtime swap
     â”‚   â€¢ Route traffic to new service
     â”‚   â€¢ Shutdown old service
     â”‚
     â””â”€â–º âœ“ Deployment complete
```

## Rollback Flow (if deployment fails)

```
Deployment fails
     â”‚
     â”œâ”€â–º Build failure?
     â”‚   â€¢ Check logs
     â”‚   â€¢ Fix code
     â”‚   â€¢ Push again
     â”‚
     â”œâ”€â–º Migration failure?
     â”‚   â€¢ Service stays on old version
     â”‚   â€¢ Fix migration
     â”‚   â€¢ Redeploy
     â”‚
     â””â”€â–º Health check failure?
         â€¢ Service stays on old version
         â€¢ Fix startup issue
         â€¢ Redeploy
```

---

**Legend:**
- `â”‚ â–¼ â–²` : Flow direction
- `â”Œâ”€â” â””â”€â”˜` : Container boundaries
- `â€¢` : List items / Sub-steps
- `âœ“` : Success indicator
- `$` : Shell command
