# Railpack Configuration for PaCo FastAPI Backend
# Ensures Railway builds the FastAPI app, not the Streamlit app

[project]
name = "paco-api"
language = "python"

[build]
# Python version (must be 3.12 or lower for embedchain compatibility)
pythonVersion = "3.12"

# Build commands
# NOTE: Set Root Directory to "paco-api" in Railway dashboard
# Then all commands run from within paco-api/
installCommand = "pip install --upgrade pip && pip install -r requirements.txt"

[start]
# Start command (runs from paco-api/ if Root Directory is set correctly)
command = "uvicorn app.main:app --host 0.0.0.0 --port $PORT"

[health]
# Health check configuration
path = "/health"
timeout = 100

[environment]
# Environment type
type = "production"

# Python-specific settings
PYTHONUNBUFFERED = "1"
PYTHONDONTWRITEBYTECODE = "1"

[watch]
# Only trigger rebuilds for changes in these paths (relative to paco-api/ root)
include = [
    "app/**/*.py",
    "requirements.txt",
    "alembic.ini",
    "alembic/**/*.py"
]

# Ignore these paths
exclude = [
    "__pycache__/**",
    "*.pyc",
    "alembic/versions/**",
    "audio_files/**",
    ".env",
    "*.log"
]
